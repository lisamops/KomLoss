---
title: Digital media supporting literacy learning in children with communicative and
  cognitive disabilities
author:
- name: Lisa Palmqvist
  affiliation: '1,2'
  corresponding: yes
  address: IBL, Linköping University, 581 83 Linköping, Sweden
  email: lisa.palmqvist@liu.se
  telephone number: "+46-13281789"
- name: Emil Holmer
  affiliation: '1,2'
- name: More authors to be added
  affiliation: 1, 2, 3,4
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: word_document
shorttitle: Digital media supporting literacy learning
abstract: |
  (ref:abstract)
keywords: "Intellectual disability, litteracy learning, phonological awareness,  phonemic
  reading strategy, comprehension-based reading, intervention."
wordcount: ' '
bibliography: library.bib
figsintext: no
figurelist: no
tablelist: no
footnotelist: no
lineno: yes
header-includes:
- \usepackage{setspace}
- \AtBeginEnvironment{tabular}{\singlespacing}
- \AtBeginEnvironment{lltable}{\singlespacing}
- \AtBeginEnvironment{tablenotes}{\doublespacing}
- \captionsetup[table]{font={stretch=1.5}}
- \captionsetup[figure]{font={stretch=1.5}}
lang: english
class: man
affiliation:
- id: '1'
  institution: Department of Behavioural Sciences and Learning, Linköping University
- id: '2'
  institution: The Swedish Institute of Disability Research
- id: '3'
  institution: DART
- id: '4'
  institution: GU
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = FALSE, results='asis', warning = FALSE, echo = FALSE, include = FALSE, message = FALSE)
options(digits=3, Encoding="UTF-8") #default decimal digits

```

```{r load_environment}
load("environment.RData")
#source('scripts/MLM_time_continous.R') #kolla upp hur man kan göra såhär istället för använda environmentgrejen. Just nu funkar inte pathen
``` 

```{r load_packages, include = FALSE}
library(papaja)
library(dplyr)
library(lmerTest)# to get p-value estimations that are not part of the standard lme4 packages 
library(lme4)
library(sjPlot)
library(ggpubr)
library(ggplot2)
library(FSA)
```

```{r analysis_preferences}
# Seed for random number generation
set.seed(42)
#knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

```{r formatting_p-values}
#Deletes 0 on r-values. 
r_format  <- function(value){
  object <- (formatC(value, digits = 3, format = "f"))
  object <- gsub("0.",".",object, fixed = TRUE)
  return(object)
  }

#Formats p-values below 0,001 into .001
p_small <- function(value){
  if (value >= 0.001 & value < 1) {
    object <-  gsub("0.","=.",format.pval(value, digits = 2, eps = 0.001, nsmall = 3), fixed = TRUE)
  } else if (value == 1) {
    object <-  gsub("1.","=1.",format.pval(value, digits = 2, eps = 0.001, nsmall = 3), fixed = TRUE)
    } else {
      object <-  gsub("0.",".",format.pval(value, digits = 2, eps = 0.001, nsmall = 3), fixed = TRUE)
} 
  return(object)}

```

(ref:abstract) **Background**: BLALBLALALBLABLABLABLALBALBLABLABLALB **Method**: `r printnum(length((mlm_data %>% filter(time == 1))$id), numerals = F, capitalize = T) ` adolescents with ID were recruited. The participants were instructed to train in school for a total of 12 hours. **Results**: Blablablablalbalba **Conclusions**: blablalbalbalbal.

# Introduction

Children with intellectual and communicative disabilities may be among the most socially disadvantaged student categories. Failing in acquiring literacy skills is a serious and common problem. The purpose of this project is to investigate the effects of two specific digital literacy learning tools (apps) on the acquisition of literacy skills in children with intellectual disability and who are reliant on augmentative and alternative communication, AAC. This means that they need aids such as manual signing, symbols/pictures, speech-generating devices, etc. to understand and/or express themselves. 

We will recruit children with intellectual disability of different etiologies from special needs schools. The age range will be broad. The children will be assigned to one of three interventions or to a comparison group that will receive teaching-as-usual (TaU). The three interventions are: 1) the ALL-Accessible Literacy Learning app (phonemic strategies); the Animega-is app (comprehension-based strategies); 3) a combination of both ALL and Animega-is. The children’s literacy development during a 12-week intervention period will be compared across the four different groups. In line with a previous study targeting children in reading difficulties (Gustafson et al., 2011), we expect a positive effect on reading and phonological awareness across all intervention groups, with the largest effect in the group receiving the combined intervention.
Hypotheses

## Hypotheses

1: Training phonemic or comprehension-based reading strategies improves phonological awareness. 
2: Training phonemic or comprehension-based reading strategies improves reading ability. 
3: The combined training is more effective than either intervention on its own.

The hypotheses will be tested on these outcome variables: phonological awareness (1, 3), word reading (2, 3), and sentence reading (2, 3).



# Methods

## Participants
Participants were recruited from special needs schools in southern Sweden, after consent of the school’s principal. Participating children  gave oral consent at the beginning of the first test session and  prior to the study, caregivers signed an informed consent, regarding the confidentiality of data and group-level analysis. The study follows the Ethical principles for medical research involving human subjects from the WMA Declaration of Helsinki [@WorldMedicalAssociation2013]. The study was reviewed and approved by the Ethical Review Board, Sweden (*insert dr no*).

In Sweden, special schools are open for children with an ID diagnosis^1. The recruitment process resulted in `r printnum(length(background_raven$id), numerals = T) ` participants ($n_{girls}$ = `r length((background_raven %>% filter(gender == "Girl"))$id) `, $n_{boys}$ = `r length((background_raven %>% filter(gender == "Boy"))$id)`). However, one participant was excluded from the study due to testing not being followed as per protocol, and the final sample thus included `r printnum(length((mlm_data %>% filter(time == 1))$id), numerals = T) ` participants (for demographics, see Table ...). Data on diagnoses were collected using parental surveys. The diagnoses in the ID group can be seen in Table\ \@ref(tab:diagnosis-table).

[^1]:In Sweden, the diagnosis Intellectual Disability is made after a thorough assessment by a licensed psychologist according to criteria from the DSM-5 [@APA2013].

##Behavioral measures   
Non-verbal intelligence and reading measures were collected. 

###Non-verbal intelligence  
The participants’ IQ were calculated based on The Raven’s 2 Progressive Matrices Clinical Edition (Raven’s 2; *Raven, Rust, Chan, & Zhou, 2018*). 

###Phonological awareness  
Three subtests from MiniDUVAN (Wolff, 2013) were used to assess phonological awareness skills: A2 Rhyme identification, A3 Phoneme identification, and B4 Phoneme synthesis. The dependent measure was total number of correct answers across all subtests (max = 45).  

###Letter-sound knowledge  
To be added...

###Word reading  
OS64 (Nielsen et al., 1997) and OLAF (Magnusson & Naucler, 2010) were used to assess word reading skills. However, the presentation of tasks, and response modes, were adapted to suit the participants in this project. In OS64, ... matched a written word to a widgit symbol. In OLAF, written words were matched to pictures. The dependent measure was the total number of correct answers (max = 15 for OS64, and max = 20 for OLAF).  

###Sentence reading  
In DLS Bas (Järpsten, 2004) the participants read short sentences and match these to their corresponding pictures. The dependent measure was the total number of correct answers (max = 20).

## Instruction materials: ALL and Animega-is


## Procedure
The training took place in the participants’ school. The participants trained in a group in schools and the teachers were instructed to allow the students to train for 300 minutes (20 sessions for 15 min, five days a week for four weeks). The teachers were asked to let the participants train by themselves and to not assist in solving the tasks for the children. No verbal or written instructions were given to the participants. A research group member attended the first training session to instruct how to operate the tablet and program. All included participants that attended the same class also trained in the same room. However, in some cases only one student in the class participated in the study. Thus, sometimes the participants trained in a group and sometimes the participant sat by themselves, but the participant always trained on their own.

### Time
The children were tested on four occasions, before the intervention, half way through the intervention, right after the intervention, and at a six week follow-up after the intervention had stopped. Due to practical and external reasons (e.g. restrictions and sick leave due to the COVID-19 pandemic), the testing could not be done with the same intervals for all children. Thus, time was coded as an interval variable rather than a categorical, using days and the first testing time set to 0. 

### Training time
Training time was extracted from time spent training in the program and was measured in minutes. 

## Data analysis
The $\alpha$-value was set to 0.05.

For all our analyses, we used `r cite_r("r-references.bib")`. DETTA MÅSTE KOMPLETTERAS SÅ ATT RÄTT REFERENSER KOMMER MED.


### Statistical analysis
In the preregistration, it was stated that mixed ANOVAs was going to be used. However, due to the children not being tested with the same time intervals, missing data, and the groups not being matched on IQ, linear mixed-effects models with repeated measures was used to analyze the effects of the interventions. Linear mixed-effects models are superior to ANOVA when dealing with missing data, and the difference in IQ and time intervals for testing (@kalla). Models were fitted with the lme4 package (@kalla) in R using using maximum likelihood and missing data was handled under the less restrictive assumption of missing at random. The assumption of linearity was tested by plotting the model-predicted values to the observed ones, homogeneity of variance was tested by plotting the residuals vs. fitted values. To check that the residuals of the model were normally distributed using a QQ plot. For the sentence reading, the residuals were non-normally distributed, thus a Generalized linear mixed-model with a Poisson distribution was used rather than a Gaussian distribution.

### Procedure modelling building
The effects of the interventions were evaluated on the four different outcome measures separately. The outcome measures were phonological awareness (PA), word reading, sentence reading, and letter-sound recognition. To evaluate the effects of the interventions, we first build an unconditional model (Model 1) with time as a fixed effect and participants as a random intercept. Thereafter, we added time as a random intercept (Model 2) and compared it to Model 1. If Model 2 were significantly better than Model 1, we included time as a random intercept, otherwise time was only included as a fixed effect. To test Hypothesis 1 and 2 respectively, we build a conditional model, Model 3, were we added intervention as a binary variable (0 = comparison group, 1 = intervention groups). Thereafter, we added IQ as a control variable in Model 4 to see if it interacted with the effect of the intervention. Only Model 3 and Model 4 will be presented in the result section, the other models can be found in the supplements. Thereafter, we investigated Hypothesis 3, if the combined training was more effective than the ALL and Animega-is on their own. The same procedure of model building was repeated for this hypothesis testing. 

### Covariance structure
Random effects were fitted with both no covariance structure (variance components) and an unstructured variance-covariance matrix. The unstructured covariance-matrix was used if it significantly improved the model, otherwise the less complex (?), no covariance structure was used.


### Model comparison
Models were compared using an ANOVA (or loglikelihoodtest och chi2, tror det är samma måste jämföra med Emil) when the same amount of parameters were estimated in the models and by using AIC scores when different parameters were used (ELLER HUR SKA VI GÖRA?). 

# Results
The descriptive statistics for all variables on each assessment time can be seen in Table\ \@ref(tab:descriptives-table).

```{r descriptives-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

mlm_data <- mlm_data %>% dplyr::mutate(years_old = age_in_days/365)

desc_data <- mlm_data %>% dplyr::select(group, time, years_old, IQ, tot_train_time)

desc_data$group <- as.numeric(desc_data$group)
desc_data$years_old <- as.numeric(desc_data$years_old)

descriptives_time <- desc_data  %>% filter(time == 1) %>% group_by(group) %>%
   summarize_all(list(Mean=~mean(., na.rm = T),  SD=~sd(., na.rm = T), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))
 
#descriptives[, -1] <- printnum(descriptives[, -1])
desc_time <- as.data.frame(t(descriptives_time))
 
descriptives_cont <- dplyr::select(desc_time, "V1")
descriptives_all <- dplyr::select(desc_time, "V2")
descriptives_animega <- dplyr::select(desc_time, "V3")
descriptives_combi <- dplyr::select(desc_time, "V4")

Means_cont <- slice(descriptives_cont, 3:5) 
SDs_cont <- slice(descriptives_cont, 7:9) 
Range_cont <- slice(descriptives_cont, 11:13) 

Means_all <- slice(descriptives_all, 3:5) 
SDs_all <- slice(descriptives_all, 7:9) 
Range_all <- slice(descriptives_all, 11:13) 

Means_animega <- slice(descriptives_animega, 3:5) 
SDs_animega <- slice(descriptives_animega, 7:9) 
Range_animega <- slice(descriptives_animega, 11:13) 

Means_combi <- slice(descriptives_combi, 3:5) 
SDs_combi <- slice(descriptives_combi, 7:9) 
Range_combi <- slice(descriptives_combi, 11:13) 
 
var_names <- as.data.frame(c( "Age", "IQ","Trained time"))
 
descTable <- bind_cols(var_names, Means_cont, SDs_cont, Range_cont, Means_all, SDs_all, Range_all, Means_animega, SDs_animega, Range_animega, Means_combi, SDs_combi, Range_combi)

col.names = c(" ", "$M_{control}$", "$SD_{control}$", "$(Range)_{control}$", "$M_{all}$", "$SD_{all}$", "$(Range)_{all}$", "$M_{animega-is}$", "$SD_{animega-is}$", "$(Range)_{animega-is}$", "$M_{combi}$", "$SD_{combi}$", "$(Range)_{combi}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics of included variables presented by group"
  , note = "Chronological is are presented in years."
  , col_spanners = list("Control" = c(2, 4), "ALL" = c(5, 7), "Animega-ia" = c(8, 10), "Combi" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

```{r desc-read-control-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

desc_data2 <- mlm_data %>% dplyr::select(-id, -days, - age_in_days, -IQ_scale, -tot_train_time_scale, -contrast_1vs234, -contrast_1vs2, -contrast_1vs3, -contrast_4vs23, -years_old, -IQ, -tot_train_time)

desc_data2$group <- as.numeric(desc_data2$group)

descriptives_control <- desc_data2  %>% filter(group == 1) %>% group_by(time) %>%
   summarize_all(list(Mean=~mean(., na.rm = T),  SD=~sd(., na.rm = T), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_control2 <- as.data.frame(t(descriptives_control))

descriptives_t1 <- dplyr::select(descriptives_control2, "V1")
descriptives_t2 <- dplyr::select(descriptives_control2, "V2")
descriptives_t3 <- dplyr::select(descriptives_control2, "V3")
descriptives_t4 <- dplyr::select(descriptives_control2, "V4")

Means_t1 <- slice(descriptives_t1, 3:6)
SDs_t1 <- slice(descriptives_t1, 8:11)
Range_t1 <- slice(descriptives_t1, 13:16)

Means_t2 <- slice(descriptives_t2, 3:6)
SDs_t2 <- slice(descriptives_t2, 8:11)
Range_t2 <- slice(descriptives_t2, 13:16)

Means_t3 <- slice(descriptives_t3, 3:6)
SDs_t3 <- slice(descriptives_t3, 8:11)
Range_t3 <- slice(descriptives_t3, 13:16)

Means_t4 <- slice(descriptives_t4, 3:6)
SDs_t4 <- slice(descriptives_t4, 8:11)
Range_t4 <- slice(descriptives_t4, 13:16)

var_names <- as.data.frame(c( "Letter", "Word","Sentence", "PA"))

descTable <- bind_cols(var_names, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the control group of included variables presented by time"
  , note = " this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

```{r desc-read-ALL-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

descriptives_all <- desc_data2  %>% filter(group == 2) %>% group_by(time) %>%
   summarize_all(list(Mean=~mean(., na.rm = T),  SD=~sd(., na.rm = T), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_all2 <- as.data.frame(t(descriptives_all))

descriptives_t1 <- dplyr::select(descriptives_all2, "V1")
descriptives_t2 <- dplyr::select(descriptives_all2, "V2")
descriptives_t3 <- dplyr::select(descriptives_all2, "V3")
descriptives_t4 <- dplyr::select(descriptives_all2, "V4")

Means_t1 <- slice(descriptives_t1, 3:6)
SDs_t1 <- slice(descriptives_t1, 8:11)
Range_t1 <- slice(descriptives_t1, 13:16)

Means_t2 <- slice(descriptives_t2, 3:6)
SDs_t2 <- slice(descriptives_t2, 8:11)
Range_t2 <- slice(descriptives_t2, 13:16)

Means_t3 <- slice(descriptives_t3, 3:6)
SDs_t3 <- slice(descriptives_t3, 8:11)
Range_t3 <- slice(descriptives_t3, 13:16)

Means_t4 <- slice(descriptives_t4, 3:6)
SDs_t4 <- slice(descriptives_t4, 8:11)
Range_t4 <- slice(descriptives_t4, 13:16)

var_names <- as.data.frame(c( "Letter", "Word","Sentence", "PA"))

descTable <- bind_cols(var_names, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the ALL group of included variables presented by time"
  , note = "this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

```{r desc-read-animega-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

descriptives_animega <- desc_data2  %>% filter(group == 3) %>% group_by(time) %>%
   summarize_all(list(Mean=~mean(., na.rm = T),  SD=~sd(., na.rm = T), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_animega2 <- as.data.frame(t(descriptives_animega))

descriptives_t1 <- dplyr::select(descriptives_animega2, "V1")
descriptives_t2 <- dplyr::select(descriptives_animega2, "V2")
descriptives_t3 <- dplyr::select(descriptives_animega2, "V3")
descriptives_t4 <- dplyr::select(descriptives_animega2, "V4")

Means_t1 <- slice(descriptives_t1, 3:6)
SDs_t1 <- slice(descriptives_t1, 8:11)
Range_t1 <- slice(descriptives_t1, 13:16)

Means_t2 <- slice(descriptives_t2, 3:6)
SDs_t2 <- slice(descriptives_t2, 8:11)
Range_t2 <- slice(descriptives_t2, 13:16)

Means_t3 <- slice(descriptives_t3, 3:6)
SDs_t3 <- slice(descriptives_t3, 8:11)
Range_t3 <- slice(descriptives_t3, 13:16)

Means_t4 <- slice(descriptives_t4, 3:6)
SDs_t4 <- slice(descriptives_t4, 8:11)
Range_t4 <- slice(descriptives_t4, 13:16)

var_names <- as.data.frame(c( "Letter", "Word","Sentence", "PA"))

descTable <- bind_cols(var_names, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the Animega-is group of included variables presented by time"
  , note = "this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

```{r desc-read-combi-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

descriptives_combi <- desc_data2  %>% filter(group == 4) %>% group_by(time) %>%
   summarize_all(list(Mean=~mean(., na.rm = T),  SD=~sd(., na.rm = T), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_combi2 <- as.data.frame(t(descriptives_combi))

descriptives_t1 <- dplyr::select(descriptives_combi2, "V1")
descriptives_t2 <- dplyr::select(descriptives_combi2, "V2")
descriptives_t3 <- dplyr::select(descriptives_combi2, "V3")
descriptives_t4 <- dplyr::select(descriptives_combi2, "V4")

Means_t1 <- slice(descriptives_t1, 3:6)
SDs_t1 <- slice(descriptives_t1, 8:11)
Range_t1 <- slice(descriptives_t1, 13:16)

Means_t2 <- slice(descriptives_t2, 3:6)
SDs_t2 <- slice(descriptives_t2, 8:11)
Range_t2 <- slice(descriptives_t2, 13:16)

Means_t3 <- slice(descriptives_t3, 3:6)
SDs_t3 <- slice(descriptives_t3, 8:11)
Range_t3 <- slice(descriptives_t3, 13:16)

Means_t4 <- slice(descriptives_t4, 3:6)
SDs_t4 <- slice(descriptives_t4, 8:11)
Range_t4 <- slice(descriptives_t4, 13:16)

var_names <- as.data.frame(c( "Letter", "Word","Sentence", "PA"))

descTable <- bind_cols(var_names, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the Combi group of included variables presented by time"
  , note = "this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

## IQ


```{r IQ in different groups}
kruskal_test_IQ <- kruskal.test(IQ~group, data = mlm_data)
DT_IQ = dunnTest(IQ ~ group, data=mlm_data, method="bh") 

# mean((mlm_data %>% filter(time == 1)%>% filter(group == "Control"))$IQ, na.rm = TRUE)
# mean((mlm_data %>% filter(time == 1)%>% filter(group == "ALL"))$IQ)
# mean((mlm_data %>% filter(time == 1)%>% filter(group == "Animega-is"))$IQ)
# mean((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$IQ)

```


The participants were randomly selected on school level to different intervention groups. This was done to try to match the groups on IQ. Nevertheless, the IQ in the groups differed significantly, *H*(`r kruskal_test_IQ[["parameter"]]`) = `r kruskal_test_IQ[["statistic"]]`, *p* `r p_small(kruskal_test_IQ[["p.value"]])`. 
@Facon2011 proposed groups be equated with an α-level of *p* > 0.50. The Animega-is group had a significantly higher IQ (
*m* =`r mean((mlm_data %>% filter(time == 1)%>% filter(group == "Animega-is"))$IQ) `; 
*sd* =`r sd((mlm_data %>% filter(time == 1)%>% filter(group == "Animega-is"))$IQ) `) compared to the Comparison group (
*m* =`r mean((mlm_data %>% filter(time == 1)%>% filter(group == "Control"))$IQ, na.rm = TRUE) `; 
*sd* =`r sd((mlm_data %>% filter(time == 1)%>% filter(group == "Control"))$IQ, na.rm = TRUE) `), 
*p* `r p_small(DT_IQ[["res"]][["P.adj"]][5]) `, the ALL group (
*m* =`r mean((mlm_data %>% filter(time == 1)%>% filter(group == "ALL"))$IQ) `; 
*sd* =`r sd((mlm_data %>% filter(time == 1)%>% filter(group == "ALL"))$IQ) `),  
*p* `r p_small(DT_IQ[["res"]][["P.adj"]][1]) `, and the combination group (
*m* =`r mean((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$IQ) `; 
*sd* =`r sd((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$IQ) `), 
*p* `r p_small(DT_IQ[["res"]][["P.adj"]][3]) `. Thus, IQ was used as a control variable in all outcome variables. 

```{r  IQ-plot, include = TRUE, results='asis'}
ggboxplot(data = mlm_data%>% filter(time == 1), x = "group", y = "IQ",
                color = "group", palette =c("springgreen4","#00AFBB", "#E7B800", "#FC4E07"),
                add = "jitter")
```

## Training time

```{r train time in different groups}
kruskal_test_TT <- kruskal.test(tot_train_time~group, data = mlm_data%>% filter(time == 1)%>% filter(group != "Control"))

```

The participants were instructed to train for a total of 18 hours (36 sessions for 30 minutes, three days a week for a 12-week period). The teachers were instructed to adapt the length of the training sessions after the need of the student. That is, if the student could not sit for a full 30 minute session the teacher was encouraged to have shorter sessions but more often than three times a week. On average the participants trained for `r mean((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE) ` (*sd* =`r sd((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE) `) minutes (`r mean((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE)/60 ` (*sd* =`r sd((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE)/60 `) hours). There was no difference on training time between the three intervention groups (*H*(`r kruskal_test_TT[["parameter"]]`) = `r kruskal_test_TT[["statistic"]]`, *p* `r p_small(kruskal_test_TT[["p.value"]])` ).

```{r  tottraintime-plot, include = TRUE, results='asis'}
ggboxplot(data = mlm_data%>% filter(time == 1)%>% filter(group != "Control"), x = "group", y= "tot_train_time",
                color = "group", palette =c("#00AFBB", "#E7B800", "#FC4E07"),
                add = "jitter")
```

## Phonological awareness

### Hypothesis 1a: Training phonemic reading strategies improves phonological awareness. 

There was almost a significant interaction between time and the intervention on phonemic reading, the group training phonemic strategies improved more than the comparison group (`r apa_print(model_PA_3)$full_result$days_contrast_1vs2`). 

### Hypothesis 1b: Training comprehension-based reading strategies improves phonological awareness. 
There was no significant interaction between time and intervention for the comprehension-based reading strategy on PA (`r apa_print(model_PA_3)$full_result$days_contrast_1vs3`). 

### Hypothesis 3: The combined training is more effective than either intervention on its own.

There was a significant interaction between the combined group and the other two intervention groups, (`r apa_print(model_PA_3)$full_result$days_contrast_4vs23`), the combined training improved PA over time more than the other two intervention groups.

```{r  PA-plot, include = TRUE, results='asis'}

#Plot data for PA
ggplot(data      = mlm_data,
       aes(x     = days,
           y     = PA,
           col   = group,
           group = group))+ #to add the colours for different classes
  geom_smooth(method   = lm,
              se       = T,
              size     = 1,
              linetype = 1,
              alpha    = .2)+
  theme_minimal()+
  labs(title    = "Phonological awareness",
       subtitle = "change over time")+
  scale_color_manual(name   =" Group",
                     labels = c("Control", "ALL", "Animega-is", "Combo"),
                     values = c("blue", "red", "green", "yellow"))
```


## Exploratory analyses

### Effect of IQ
There was a significant main effect on IQ (`r apa_print(model_PA_4)$full_result$IQ_scale`), indicating that higher IQ results in higher PA at T1. Moreover, there was a significant interaction between time and IQ (`r apa_print(model_PA_4)$full_result$days_IQ_scale`), indicating that the participants with the highest IQ benefited the most from the intervention. However, the benefit of the combined training over the two other intervention types remained (`r apa_print(model_PA_4)$full_result$days_contrast_4vs23`)

The results from the PA models can be seen in Table\ \@ref(tab:PA-table).

```{r PA-table, include = TRUE, results='asis'}
tab_model(model_PA_3, model_PA_4, show.df = TRUE)
```

## Word reading

### Hypothesis 1a: Training phonemic reading strategies improves word reading. 

There was not a significant interaction between time and the intervention on phonemic-based reading (`r apa_print(model_word_3)$full_result$scaledays_center___FALSE_contrast_1vs2`). 

### Hypothesis 1b: Training comprehension-based reading strategies improves word awareness. 
There was no significant interaction between time and intervention for the comprehension-based reading strategy on word reading (`r apa_print(model_word_3)$full_result$scaledays_center___FALSE_contrast_1vs3`). 

### Hypothesis 3: The combined training is more effective than either intervention on its own.

There was a not significant interaction between the combined group and the other two intervention groups, (`r apa_print(model_word_3)$full_result$scaledays_center___FALSE_contrast_4vs23`).

```{r  word-plot, include = TRUE, results='asis'}

#Plot data for word
ggplot(data      = mlm_data,
       aes(x     = days,
           y     = word,
           col   = group,
           group = group))+ #to add the colours for different classes
  geom_smooth(method   = lm,
              se       = T,
              size     = 1,
              linetype = 1,
              alpha    = .2)+
  theme_minimal()+
  labs(title    = "word reading over days",
       subtitle = "change in word reading over time in the different groups")+
  scale_color_manual(name   =" Group",
                     labels = c("Control", "ALL", "Animega-is", "Combo"),
                     values = c("blue", "red", "green", "yellow"))

```

## Exploratory analyses

### Effect of IQ
There was a significant main effect on IQ (`r apa_print(model_word_4)$full_result$IQ_scale`), indicating that higher IQ results in higher word reading at T1. Moreover, there was a significant interaction between time and IQ (`r apa_print(model_word_4)$full_result$scaledays_center___FALSE_IQ_scale`), indicating that the participants with the highest IQ improved  most over the training period regardless of intervention condition (including control). 

### Effect of PA
There was a significant main effect on PA (`r apa_print(model_PA_word)$full_result$scalePA_center___TRUE`), indicating that higher PA resulted in higher word reading at T1. Moreover, there was a significant interaction between time and PA (`r apa_print(model_PA_word)$full_result$days_scalePA_center___TRUE`), indicating that the participants with the highest PA improved  most over the training period regardless of intervention condition (including control). 

The results from the word models can be seen in Table\ \@ref(tab:word-table).

```{r word-table, include=TRUE, results='asis'}
tab_model(model_word_3, model_word_4, model_PA_word, show.df = TRUE)

```

# Sentence reading

### Hypothesis 1a: Training phonemic reading strategies improves sentence reading. 

There was not a significant interaction between time and the intervention on phonemic training on sentence reading (`r apa_print(DLS_poisson_3)$full_result$scaledays_center___FALSE_contrast_1vs2`). 

### Hypothesis 1b: Training comprehension-based reading strategies improves sentence awareness. 
There was no significant interaction between time and intervention for the comprehension-based reading strategy on sentence reading (`r apa_print(DLS_poisson_3)$full_result$scaledays_center___FALSE_contrast_1vs3`). 

### Hypothesis 3: The combined training is more effective than either intervention on its own.

There was a not significant interaction between the combined group and the other two intervention groups, (`r apa_print(DLS_poisson_3)$full_result$scaledays_center___FALSE_contrast_4vs23`).

```{r  DLS-plot, include = TRUE, results='asis'}

#Plot data for DLS
ggplot(data      = mlm_data,
       aes(x     = days,
           y     = DLS,
           col   = group,
           group = group))+ #to add the colours for different classes
  geom_smooth(method   = lm,
              se       = T,
              size     = 1,
              linetype = 1,
              alpha    = .2)+
  theme_minimal()+
  labs(title    = "DLS over days",
       subtitle = "change in sentence reading over time in the different groups")+
  scale_color_manual(name   =" Group",
                     labels = c("Control", "ALL", "Animega-is", "Combo"),
                     values = c("blue", "red", "green", "yellow"))

```

## Exploratory analyses

### Effect of IQ
There was a significant main effect on IQ (`r apa_print(DLS_poisson_4)$full_result$IQ_scale`), indicating that higher IQ results in higher sentence reading at T1. Moreover, there was a significant interaction between time and IQ (`r apa_print(DLS_poisson_4)$full_result$IQ_scale_scaledays_center___FALSE`), indicating that the participants with the highest IQ improved  most over the training period regardless of intervention condition (including control). 

### Effect of PA
There was a significant main effect on PA (`r apa_print(model_PA_DLS)$full_result$scalePA_center___TRUE`), indicating that higher PA resulted in higher word reading at T1. However, there was not a significant interaction between time and PA (`r apa_print(model_PA_DLS)$full_result$scaledays_center___FALSE_scalePA_center___TRUE`), indicating that the participants' PA did not affect the improvement rate over the training period. 

The results from the word models can be seen in Table\ \@ref(tab:DLS-table).

```{r DLS-table, include=TRUE, results='asis'}
tab_model(DLS_poisson_3, DLS_poisson_4, model_PA_DLS)
```

# Explorative analyses
## Letter-sound recognition

### Hypothesis 1a: Training phonemic reading strategies improves letter-sound recognition. 

There was a significant interaction between time and the intervention on phonemic training on letter-sound recognition (`r apa_print(model_letter_3)$full_result$scaledays_center___FALSE_contrast_1vs2`). 

### Hypothesis 1b: Training comprehension-based reading strategies improves sletter-sound recognition. 
There was no significant interaction between time and intervention for the comprehension-based reading strategy on letter-sound recognition (`r apa_print(model_letter_3)$full_result$scaledays_center___FALSE_contrast_1vs3`). 

### Hypothesis 3: The combined training is more effective than either intervention on its own.
There was a not significant interaction between the combined group and the other two intervention groups, (`r apa_print(model_letter_3)$full_result$scaledays_center___FALSE_contrast_4vs23`).

```{r  letter-plot, include = TRUE, results='asis'}

#Plot data for letter
ggplot(data      = mlm_data,
       aes(x     = days,
           y     = letter,
           col   = group,
           group = group))+ #to add the colours for different classes
  geom_smooth(method   = lm,
              se       = T,
              size     = 1,
              linetype = 1,
              alpha    = .2)+
  theme_minimal()+
  labs(title    = "Letter-sound recognition reading over days",
       subtitle = "change in letter-sound recognition over time in the different groups")+
  scale_color_manual(name   =" Group",
                     labels = c("Control", "ALL", "Animega-is", "Combo"),
                     values = c("blue", "red", "green", "yellow"))
```

### Effect of IQ
There was a significant main effect on IQ (`r apa_print(model_letter_4)$full_result$IQ_scale`), indicating that higher IQ results in higher sentence reading at T1. However, there was not a significant interaction between time and IQ (`r apa_print(model_letter_4)$full_result$scaledays_center___FALSE_IQ_scale`), indicating that the participants' IQ did not affect the improvement rate over the training period. 

### Effect of PA
There was a significant main effect on PA (`r apa_print(model_PA_letter)$full_result$scalePA_center___TRUE`), indicating that higher PA resulted in higher word reading at T1. Moreover, there was a significant interaction between time and PA (`r apa_print(model_PA_letter)$full_result$days_scalePA_center___TRUE`), indicating that the participants with the highest PA improved most over the training period regardless of intervention condition (including control). 

The results from the word models can be seen in Table\ \@ref(tab:letter-table).

```{r letter-table, include=TRUE, results='asis'}
tab_model(model_letter_3, model_letter_4, model_PA_letter, show.df = TRUE)
```


# marginal and conditional R2  
A marginal R2 close to zero tells us that the fixed effects aren’t explaining much variation, and a conditional R2 close to 1 tells us that most of that unexplained variation is between groups (people) rather than between observations within groups (people). So, for example, if the context was a longitudinal cohort study, we wouldn’t expect to improve our model much by collecting more data on characteristics/measures that mainly vary within people, but instead should find characteristics that mainly vary between people.


# Results summary

Combination group improves more on PA compared to the other intervention groups. ALL intervention improves letter-sound recognition more than other intervention groups. IQ influences improvement over time on many outcome measures (sammanfatta vilka här). PA interacts with time on letter-sound recognition, word reading and sentence reading, suggesting that PA predicts improvement in those outcome variables. 

# Discussion
Blablablablalba

##Conclusions
Blablabla

##Declaration of interest
Blablabla


\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
#r_refs(file = "library.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
