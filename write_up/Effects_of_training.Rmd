---
title: Digital media supporting literacy learning in children with communicative and
  cognitive disabilities
author:
- name: Lisa Palmqvist
  affiliation: '1,2'
  corresponding: yes
  address: IBL, Linköping University, 581 83 Linköping, Sweden
  email: lisa.palmqvist@liu.se
  telephone number: +46-13281789
- name: Emil Holmer
  affiliation: '1,2'
- name: More authors to be added
  affiliation: 1, 2, 3,4
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
abstract: |
  (ref:abstract)
keywords: Intellectual disability, litteracy learning, phonological awareness,  phonic-based
  reading strategy, comprehension-based reading, intervention.
wordcount: ' '
bibliography: library.bib
figsintext: no
figurelist: no
tablelist: no
footnotelist: no
lineno: yes
header-includes:
- \usepackage{setspace}
- \AtBeginEnvironment{tabular}{\singlespacing}
- \AtBeginEnvironment{lltable}{\singlespacing}
- \AtBeginEnvironment{tablenotes}{\doublespacing}
- \captionsetup[table]{font={stretch=1.5}}
- \captionsetup[figure]{font={stretch=1.5}}
lang: english
class: man
affiliation:
- id: '1'
  institution: Department of Behavioural Sciences and Learning, Linköping University
- id: '2'
  institution: The Swedish Institute of Disability Research
- id: '3'
  institution: DART
- id: '4'
  institution: GU
shorttitle: Digital media supporting literacy learning
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = FALSE, results='asis', warning = FALSE, echo = FALSE, include = FALSE, message = FALSE)
options(digits=3, Encoding="UTF-8") #default decimal digits

```

```{r load_environment}
load("environment.RData")
#source('scripts/MLM_time_continous.R') #kolla upp hur man kan göra såhär istället för använda environmentgrejen. Just nu funkar inte pathen
``` 

```{r load_packages, include = FALSE}
library(papaja)
library(dplyr)
library(lmerTest)# to get p-value estimations that are not part of the standard lme4 packages 
library(lme4)
library(sjPlot) #plot tables from lmer() mlm-models
library(ggpubr)
library(ggplot2)
library(FSA)
```

```{r analysis_preferences}
# Seed for random number generation
set.seed(42)
#knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
library(pander)
#panderOptions('digits', 2)
panderOptions('round', 2)
panderOptions('keep.trailing.zeros', TRUE)
```

```{r formatting_p-values}
#Deletes 0 on r-values. 
r_format  <- function(value){
  object <- (formatC(value, digits = 3, format = "f"))
  object <- gsub("0.",".",object, fixed = TRUE)
  return(object)
  }

#Formats p-values below 0,001 into .001
p_small <- function(value){
  if (value >= 0.001 & value < 1) {
    object <-  gsub("0.","=.",format.pval(value, digits = 2, eps = 0.001, nsmall = 3), fixed = TRUE)
  } else if (value == 1) {
    object <-  gsub("1.","=1.",format.pval(value, digits = 2, eps = 0.001, nsmall = 3), fixed = TRUE)
    } else {
      object <-  gsub("0.",".",format.pval(value, digits = 2, eps = 0.001, nsmall = 3), fixed = TRUE)
} 
  return(object)}

```

(ref:abstract) **Background**: BLALBLALALBLABLABLABLALBALBLABLABLALB **Method**: `r printnum(length((mlm_data %>% filter(time == 1))$id), numerals = F, capitalize = T) ` adolescents with ID were recruited. The participants were instructed to train in school for a total of 12 hours. **Results**: Blablablablalbalba **Conclusions**: blablalbalbalbal.

# Introduction

to be added...  

## Hypotheses

1: Training phonic-based or comprehension-based reading strategies improves phonological awareness. 
2: Training phonic-based or comprehension-based reading strategies improves reading ability. 
3: The combined training is more effective than either intervention on its own.

The hypotheses will be tested on these outcome variables: phonological awareness (1, 3), word recognition (2, 3), and reading comprehension (2, 3).



# Methods

Data presented in this paper is collected in a larger project. Parts of the data has been used for this paper, for the purpose of this paper we have excluded for speech sound production which have been published in Samuelsson et al., (under revision). For a full description of collected data see (Palmqvist, Samuelsson, et al., 2020).

## Participants 
Inclusion criteria was to attend to a Swedish special needs school, to benefit from AAC, and to be a beginner at reading. To attend the Swedish special needs curriculum, the student has received an ID diagnosis after an assessment led by a licensed psychologist. The teachers were instructed to identify students that would benefit from AAC and could not read more than approx. 20 words. No exclusion criteria were set for age or aetiology of the ID. 

The participants were requited via email to teachers at special needs schools in Sweden. To reduce the risk of having unbalanced groups, the teachers were asked, together with their notification of interest, specify how many students in their class that fulfilled the inclusion criteria and what level of ID the students had. Thereafter, the plan was for a researcher to allocate the participants on school level to the different intervention groups. However, only 60 participants were requited, and data collection had to start due to time constraints. Thus, the participants could only be assigned to two groups, namely the comparison and the ALL group. The remainder 77 the participants were recruited after the data collection of the comparison and ALL group had started. The participants to the Animega-is and Combination group was recruited and allocated in the same way as described above. This resulted in the groups not being equated on level of ID, see the result section. 
Caregivers signed an informed consent regarding the confidentiality of data and group-level analysis. The participating children gave oral consent at the beginning of the first test session. The study follows the Ethical principles for medical research involving human subjects from the WMA Declaration of Helsinki (World Medical Association 2013). The study was reviewed and approved by the Ethical Review Board, Sweden (2020-06215).

## Design
The study is a longitudinal between-group study, with four time points (before, during, after the intervention and a follow-up). Three intervention groups: one applying a phonic-based reading strategy (using ALL), one applying a comprehension-based strategy (using Animega-is), and the third applying both strategies (using ALL and Animega-is), and a comparison group who received regular teaching, not focusing one specific reading instruction strategy. Due to practical reasons, students were allocated to intervention groups on school-level, i.e., all participants at one school received the same intervention. 

## Procedure  
Testing took place in a silent environment at the participants’ school. The students were offered to have a teacher or an assistant present during the assessment. The students’ reading ability were assessed at four times, before (t1), during (t2; approx. at half-time), and after the intervention (t3) as well as at a 12-week follow-up (t4). For most of the test situations, t1 and t3 were administered by researchers, t2 and t4 were administered by a special need teacher or a school-based speech and language pathologist. Data was collected during the Covid19-pandemic, January 2020 to June 2021, thus, the test administrators were interchanged as schools introduced restrictions for visitors. Test administrators practiced the test procedure before data collection began. Test order was fixed over sessions and students. The test session lasted ~45-75 minutes, including short breaks. During breaks, students were offered a small snack, water, or to move around in the room for a few minutes.  
The literacy training took place in the participants’ school. The teachers were instructed to allow the students to train for 300 minutes (20 sessions for 15 min, five days a week for four weeks). The teachers were asked to not assist in solving the tasks for the children. The teacher was asked to administer the training as they saw fit for each student, meaning that they were able to split the training sessions into smaller sessions or train individually, or in group. 

## Behavioral measures   
The participants were assessed on non-verbal intelligence, phonological awareness, word recognition, and reading comprehension (in that order). All tests started with two practice items. All tests were adapted so that the student was able to give a non-verbal response option if preferred. All instructions were presented verbally in combination with complementary manual signs and pictures. A test was terminated if the student gave three consecutive incorrect responses, except for Raven’s where the test was terminated after six consecutive incorrect responses.

### Non-verbal intelligence  
To estimate the participants’ IQ level, the Raven’s 2 Progressive Matrices Clinical Edition (Raven’s 2; Raven, Rust, Chan, & Zhou, 2018) was used. The three first modules (A, B, and C) were used, with a total of 36 items. IQ was calculated following the standardized procedure of the test and this was used as the dependent measure (with a minimum score of 40). 

### Phonological awareness  
To assess phonological awareness skills the subtests Phoneme synthesis, Phoneme identification, and Rhyme identification from MiniDUVAN (Wolff, 2013) were administered.  Each subtest constituted of two practice items followed by nine test items. In the subtest Phoneme synthesis, the test leader pronounced a word segmented by three to five sounds. The participant was asked to identify the correct word by choosing between three pictures, one representing the correct word and two lures. For example, the test leader said “can you point at /s/ /u/ /n/”, with a break between each sound on approximately one second. In the subtest Phoneme identification, the participant was presented with a picture of the sun and asked to point to another picture with an object with the same initial phoneme in its name (e.g., “This is a sun. Sun starts with /s/. Point to the picture that start with the same sound /s/.”). The target phoneme was the same for all items. Three pictures were presented, one target and three lures. In the last subtest, Rhyme identification, the participant was asked to say whether two spoken words rhymed or not (e.g., “does hat – cat rhyme?”). The participant could choose to respond verbally, by pointing to pictures representing “yes” or “no”, or using a personal AAC mode. The dependent variable was total number of correct answers across all subtests (0-27).

### Word recognition  
Two tests were used to assess word recognition skill; OS64 (Magnusson & Naucler, 2010) and OLAF (Magnusson & Naucler, 2010). In both tests, the student was asked to match a written word to a picture. Widget symbols were added to OS64 to enable non-verbal response. As the test had different number of maximum scores (OS64: 0-15, OLAF: 0-13), z-values were calculated based on the number of correct responses and a mean z-score was used as a dependent variable.  

### Reading comprehension   
In DLS Bas (Järpsten, 2004) the participant read short sentences and matched them to their corresponding picture. The degree of difficulty increased with each sentence, starting with a two-word sentence, and ending with a task consisting of two sentences with a total of 11 words. The dependent measure was total number of correct answers (max = 20).

## Materials: ALL and Animega-is

### A digital comprehension-based app: Animega-is
Animega-is has two different learning modes and both are adapted for use with AAC. In the create mode, the learner creates events with the help of text buttons, which are then followed by a animation corresponding to the event that was created. In the test mode, the learner can test his or her proficiency by first viewing the event, then choosing words and creating the sentence that best represents what he or she has just viewed. The app provides several levels of complexity as well as in-built comprehension tests. 
The  app provides several  levels  of complexity  as  well  as in-built  comprehension  tests. The  language  matter  of  the  program  is meant to be explored by the learner with help from -and in interaction with –a teacher. The language material and the appended animations not only offer motivational literacy training but also give room for conversations where the learner can express his or her imagination and thoughts. The goal is to achieve an errorless co-construction of meaning from text through multimedia and supportive interaction. There is also an editing possibility for the teacher to use. Here, the animations can be individualized by adding photos relevant to the child’s environment.

### A digital phonic-based app: Accessible Literacy Learning
The Accessible Literacy Learning (ALL) program is a program for literacy instruction for children with complex communication needs especially children with AAC (Light et al., 2008; Light & McNaughton, 2012, 2014). Only the modules using phonic training was used. The reading instruction includes: sound blending, phoneme segmentation, letter-sound correspondences, and phonological decoding. The exercises were accompanied by pictorial material/images to enable participation without speech. 

## Statistical analysis
Linear mixed-effects models were used to evaluate the effects of the intervention. In the pre-registration, we stated that mixed ANOVA was going to be used. However, due to the children not being tested with the same time intervals (due to logistic reasons), missing data, and the groups differing on IQ, linear mixed-effects models with repeated measures were used to analyze the effects of the interventions. Linear mixed-effects models are better suited compared to ANOVA when dealing with missing data and varying time intervals (källa). Models were fitted using the lme4 package (källa) in R. Maximum likelihood estimation was applied and missing data was handled under the assumption of missing at random. The assumption of linearity was tested by plotting the model-predicted values to the observed ones and homogeneity of variance was tested by plotting the residuals vs. fitted values. To check that the residuals of the model were normally distributed, Q-Q plots were investigated with an ocular inspection. The α-value was set to 0.05.

### Model building
The three different outcome measures (PA, word recognition, and reading comprehension) were analyzed separately. Days were used as the time variable, starting day 1 at the date of t1. Model fit was assessed using ANOVA. The model with the best fit, indicated with Chi2, was chosen. Normal distribution was used for all models besides reading comprehension, where the residuals were non-normally distributed. Therefore, a Poisson distribution was used. The two models were compared, and the model with Poisson distribution was much better in terms of AIC and loglikelihood compared to a model with Gaussian distribution.
First an unconditional model including a fixed effect of time was built (Model 1). Random effects were thereafter fitted with both no covariance structure (variance components) (Model 2a), and an unstructured variance-covariance matrix (Model 2b). The unstructured covariance-matrix was used if it significantly improved the model, otherwise the less complex (?) no covariance structure was used. If the model with random effects had a better fit than Model 1, random slope was used in the succeeding models when investigating the effects of the intervention otherwise no random slope was used. This procedure was repeated for each outcome measure. As a result, random slopes were included in the models for the variables word recognition, and reading comprehension. No random slope was used in the PA model.  
After fitting the unconditional models, a conditional model (Model 3) was built using contrasts to test the Hypotheses. There were three contrasts performed: comparison group versus phonic-based intervention (Hypothesis 1), comparison versus comprehension-based intervention (Hypothesis 2), and combination versus phonic-based and comprehension-based intervention (Hypothesis 3). 

# Results  
The recruitment process resulted in `r printnum(length(background_raven$id), numerals = T) ` participants ($n_{girls}$ = `r length((background_raven %>% filter(gender == "Girl"))$id) `, $n_{boys}$ = `r length((background_raven %>% filter(gender == "Boy"))$id)`). However, `r printnum((length(background_raven$id))-(length((mlm_data %>% filter(time == 1))$id)), numerals = F) ` participants were excluded from the study, one due to testing not being followed as per protocol, and three that dropped out of the study after the first testing session. Thus,the final sample thus included `r printnum(length((mlm_data %>% filter(time == 1))$id), numerals = T) ` participants ($n_{girls}$ = `r length((mlm_data  %>% filter(time == 1) %>% filter(gender == "Girl"))$id) `, $n_{boys}$ = `r length((mlm_data  %>% filter(time == 1) %>% filter(gender == "Boy"))$id)`). The control group = `r printnum(length((mlm_data %>% filter(time == 1)%>% filter(group == "Control"))$id), numerals = T) `, the phonic-based group = `r printnum(length((mlm_data %>% filter(time == 1)%>% filter(group == "ALL"))$id), numerals = T) `, the comprehension-based group = `r printnum(length((mlm_data %>% filter(time == 1)%>% filter(group == "Animega-is"))$id), numerals = T) `, and the combination group = `r printnum(length((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$id), numerals = T) `, for age, IQ, and instruction duration for each group, see Table X. Data on diagnoses were collected using parental surveys. The diagnoses in the ID group can be seen in Table\ \@ref(tab:diagnosis-table).
The descriptive statistics for all variables on each assessment time can be seen in Table\ \@ref(tab:descriptives-table).

```{r descriptives-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

mlm_data <- mlm_data %>% dplyr::mutate(years_old = age_in_days/365)

desc_data <- mlm_data %>% dplyr::select(group, time, years_old, IQ, tot_train_time, PPC)

desc_data$group <- as.numeric(desc_data$group)
desc_data$years_old <- as.numeric(desc_data$years_old)

descriptives_time <- desc_data  %>% filter(time == 1) %>% group_by(group) %>%
   summarize_all(list(Mean=~round(mean(., na.rm = T), digits = 2),  SD=~round(sd(., na.rm = T), digits = 2), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

# Skapar en tabell med n i vaje grupp för varje variabel. Osäker på om den behövs, kanske räcker med att skriva i löptext när vi säger vilka data som saknas. 
# not.na = function(x) {sum(!is.na(x))}
# stats = c('not.na')
# n_table = desc_data %>%
#  filter(time == 1) %>%
#   group_by(group) %>% summarise_all(.funs = stats)

kruskal_test_IQ <- kruskal.test(IQ~group, data = mlm_data %>% filter(time == 1)) 
kruskal_test_years_old <- kruskal.test(years_old~group, data = mlm_data %>% filter(time == 1)) 
kruskal_test_TT <- kruskal.test(tot_train_time~group, data = mlm_data%>% filter(time == 1)%>% filter(group != "Control"))
 
#descriptives[, -1] <- printnum(descriptives[, -1])
desc_time <- as.data.frame(t(descriptives_time))
 
descriptives_cont <- dplyr::select(desc_time, "V1")
descriptives_all <- dplyr::select(desc_time, "V2")
descriptives_animega <- dplyr::select(desc_time, "V3")
descriptives_combi <- dplyr::select(desc_time, "V4")

Means_cont <- slice(descriptives_cont, 3:6) 
SDs_cont <- slice(descriptives_cont, 8:11) 
Range_cont <- slice(descriptives_cont, 13:16) 

Means_all <- slice(descriptives_all, 3:6) 
SDs_all <- slice(descriptives_all, 8:11) 
Range_all <- slice(descriptives_all, 13:16) 

Means_animega <- slice(descriptives_animega, 3:6) 
SDs_animega <- slice(descriptives_animega, 8:11) 
Range_animega <- slice(descriptives_animega, 13:16) 

Means_combi <- slice(descriptives_combi, 3:6) 
SDs_combi <- slice(descriptives_combi, 8:11) 
Range_combi <- slice(descriptives_combi, 13:16) 
 
var_names <- as.data.frame(c( "Age", "IQ","Instruction duration", "Communication"))

kruskal_test_IQ <- kruskal.test(IQ~group, data = mlm_data) 
DT_IQ = dunnTest(IQ ~ group, data=mlm_data, method="bh")  #Follow up test for Kruskal Wallis

KW_test <- c(kruskal.test(years_old~group, data = mlm_data %>% filter(time == 1))$p.value, #variances not equal
            kruskal.test(IQ~group, data = mlm_data %>% filter(time == 1))$p.value, #variances equal
            kruskal.test(tot_train_time~group, data = mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$p.value,  #variances equal
            kruskal.test(PPC~group, data = mlm_data %>% filter(time == 1))$p.value #variances equal
           )

bon_t <- p.adjust(KW_test, method = "holm", n = length(KW_test)) #korrigerar för multiple comparisons, är det vettigt att göra det här?
KW_test <- bon_t
KW_test <- as.data.frame(gsub("0.",".",format.pval(KW_test, digits = 1, eps = 0.001, nsmall = 3), fixed = TRUE))

 
descTable <- bind_cols(var_names, Means_cont, SDs_cont, Range_cont, Means_all, SDs_all, Range_all, Means_animega, SDs_animega, Range_animega, Means_combi, SDs_combi, Range_combi, KW_test)

col.names = c(" ", "$M_{control}$", "$SD_{control}$", "$(Range)_{control}$", "$M_{PB}$", "$SD_{PB}$", "$(Range)_{PB}$", "$M_{CB}$", "$SD_{CB}$", "$(Range)_{CB}$", "$M_{combi}$", "$SD_{combi}$", "$(Range)_{combi}$", "$p$")

apa_table(
  descTable
  , caption = "Descriptive statistics of included variables presented by group"
  , note = "Chronological age is  presented in years."
  , col_spanners = list("Control" = c(2, 4), "PB" = c(5, 7), "Animega-ia" = c(8, 10), "Combi" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)
```

```{r ID-diagnosis, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

diagnosis_data <- mlm_data %>% filter(time == 1) %>% dplyr::select(`Only ID`, Autismspektrumtillstand, `Downs syndrom`, CP, `ADHD/ADD`, Other)

diagnosis_data$`Only ID` <- as.integer(diagnosis_data$`Only ID`)
diagnosis_data$Autismspektrumtillstand <- as.integer(diagnosis_data$Autismspektrumtillstand)
diagnosis_data$`Downs syndrom` <- as.integer(diagnosis_data$`Downs syndrom`)
diagnosis_data$CP <- as.integer(diagnosis_data$CP)
diagnosis_data$`ADHD/ADD` <- as.integer(diagnosis_data$`ADHD/ADD`)
diagnosis_data$Other <- as.integer(diagnosis_data$Other)

diagnosis_table <- diagnosis_data  %>%
   summarise_all(sum)

apa_table(
  diagnosis_table
  , caption = "Diagnoses in sample"
  , note = "Some participants can have more than one additional diagnosis"
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```


```{r desc-read-control-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

desc_data2 <- mlm_data %>% dplyr::select(-id, -days, - age_in_days, -IQ_scale, -tot_train_time_scale, -contrast_1vs234, -contrast_1vs2, -contrast_1vs3, -contrast_4vs23, -years_old, -IQ, -tot_train_time, -gender, -letter)

desc_data2$group <- as.numeric(desc_data2$group)

descriptives_control <- desc_data2  %>% filter(group == 1) %>% group_by(time) %>%
   summarize_all(list(Mean=~round(mean(., na.rm = T), digits = 2),  SD=~round(sd(., na.rm = T), digits = 2), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))


#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_control2 <- as.data.frame(t(descriptives_control))

Response_variable <- c("PA", "Word recogniton", "Reading comprehension")
#T1
Means_t1 <- c(descriptives_control2['PA_Mean',"V1"], descriptives_control2['word_Mean',"V1"], descriptives_control2['DLS_Mean',"V1"])
SDs_t1 <- c(descriptives_control2['PA_SD', "V1"], descriptives_control2['word_SD', "V1"], descriptives_control2['DLS_SD', "V1"])
Range_t1 <- c(descriptives_control2['PA_Range', "V1"], descriptives_control2['word_Range', "V1"], descriptives_control2['DLS_Range', "V1"])
#T2
Means_t2 <- c(descriptives_control2['PA_Mean', "V2"], descriptives_control2['word_Mean', "V2"], descriptives_control2['DLS_Mean', "V2"])
SDs_t2 <- c(descriptives_control2['PA_SD', "V2"], descriptives_control2['word_SD', "V2"], descriptives_control2['DLS_SD', "V2"])
Range_t2 <- c(descriptives_control2['PA_Range', "V2"], descriptives_control2['word_Range', "V2"], descriptives_control2['DLS_Range', "V2"])
#T3
Means_t3 <- c(descriptives_control2['PA_Mean', "V3"], descriptives_control2['word_Mean', "V3"], descriptives_control2['DLS_Mean', "V3"])
SDs_t3 <- c(descriptives_control2['PA_SD', "V3"], descriptives_control2['word_SD', "V3"], descriptives_control2['DLS_SD', "V3"])
Range_t3 <- c(descriptives_control2['PA_Range', "V3"], descriptives_control2['word_Range', "V3"], descriptives_control2['DLS_Range', "V3"])
#T4
Means_t4 <- c(descriptives_control2['PA_Mean', "V4"], descriptives_control2['word_Mean', "V4"], descriptives_control2['DLS_Mean', "V4"])
SDs_t4 <- c(descriptives_control2['PA_SD', "V4"], descriptives_control2['word_SD', "V4"], descriptives_control2['DLS_SD', "V4"])
Range_t4 <- c(descriptives_control2['PA_Range', "V4"], descriptives_control2['word_Range', "V4"], descriptives_control2['DLS_Range', "V4"])

descTable <- data.frame(Response_variable, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)

var_names <- as.data.frame(c( "Word recognition","Sentence", "PA"))

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the control group of included variables presented by time"
  , note = " this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

```{r desc-read-PB-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

descriptives_all <- desc_data2  %>% filter(group == 2) %>% group_by(time) %>%
   summarize_all(list(Mean=~round(mean(., na.rm = T), digits = 2),  SD=~round(sd(., na.rm = T), digits = 2), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_all2 <- as.data.frame(t(descriptives_all))

Response_variable <- c("PA", "Word recogniton", "Reading comprehension")
#T1
Means_t1 <- c(descriptives_control2['PA_Mean',"V1"], descriptives_control2['word_Mean',"V1"], descriptives_control2['DLS_Mean',"V1"])
SDs_t1 <- c(descriptives_control2['PA_SD', "V1"], descriptives_control2['word_SD', "V1"], descriptives_control2['DLS_SD', "V1"])
Range_t1 <- c(descriptives_control2['PA_Range', "V1"], descriptives_control2['word_Range', "V1"], descriptives_control2['DLS_Range', "V1"])
#T2
Means_t2 <- c(descriptives_control2['PA_Mean', "V2"], descriptives_control2['word_Mean', "V2"], descriptives_control2['DLS_Mean', "V2"])
SDs_t2 <- c(descriptives_control2['PA_SD', "V2"], descriptives_control2['word_SD', "V2"], descriptives_control2['DLS_SD', "V2"])
Range_t2 <- c(descriptives_control2['PA_Range', "V2"], descriptives_control2['word_Range', "V2"], descriptives_control2['DLS_Range', "V2"])
#T3
Means_t3 <- c(descriptives_control2['PA_Mean', "V3"], descriptives_control2['word_Mean', "V3"], descriptives_control2['DLS_Mean', "V3"])
SDs_t3 <- c(descriptives_control2['PA_SD', "V3"], descriptives_control2['word_SD', "V3"], descriptives_control2['DLS_SD', "V3"])
Range_t3 <- c(descriptives_control2['PA_Range', "V3"], descriptives_control2['word_Range', "V3"], descriptives_control2['DLS_Range', "V3"])
#T4
Means_t4 <- c(descriptives_control2['PA_Mean', "V4"], descriptives_control2['word_Mean', "V4"], descriptives_control2['DLS_Mean', "V4"])
SDs_t4 <- c(descriptives_control2['PA_SD', "V4"], descriptives_control2['word_SD', "V4"], descriptives_control2['DLS_SD', "V4"])
Range_t4 <- c(descriptives_control2['PA_Range', "V4"], descriptives_control2['word_Range', "V4"], descriptives_control2['DLS_Range', "V4"])

descTable <- data.frame(Response_variable, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)

var_names <- as.data.frame(c( "Word recognition","Sentence", "PA"))

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the Phonic-based group of included variables presented by time"
  , note = "this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

```{r desc-read-animega-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

descriptives_animega <- desc_data2  %>% filter(group == 3) %>% group_by(time) %>%
   summarize_all(list(Mean=~round(mean(., na.rm = T), digits = 2),  SD=~round(sd(., na.rm = T), digits = 2), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_animega2 <- as.data.frame(t(descriptives_animega))

Response_variable <- c("PA", "Word recogniton", "Reading comprehension")
#T1
Means_t1 <- c(descriptives_control2['PA_Mean',"V1"], descriptives_control2['word_Mean',"V1"], descriptives_control2['DLS_Mean',"V1"])
SDs_t1 <- c(descriptives_control2['PA_SD', "V1"], descriptives_control2['word_SD', "V1"], descriptives_control2['DLS_SD', "V1"])
Range_t1 <- c(descriptives_control2['PA_Range', "V1"], descriptives_control2['word_Range', "V1"], descriptives_control2['DLS_Range', "V1"])
#T2
Means_t2 <- c(descriptives_control2['PA_Mean', "V2"], descriptives_control2['word_Mean', "V2"], descriptives_control2['DLS_Mean', "V2"])
SDs_t2 <- c(descriptives_control2['PA_SD', "V2"], descriptives_control2['word_SD', "V2"], descriptives_control2['DLS_SD', "V2"])
Range_t2 <- c(descriptives_control2['PA_Range', "V2"], descriptives_control2['word_Range', "V2"], descriptives_control2['DLS_Range', "V2"])
#T3
Means_t3 <- c(descriptives_control2['PA_Mean', "V3"], descriptives_control2['word_Mean', "V3"], descriptives_control2['DLS_Mean', "V3"])
SDs_t3 <- c(descriptives_control2['PA_SD', "V3"], descriptives_control2['word_SD', "V3"], descriptives_control2['DLS_SD', "V3"])
Range_t3 <- c(descriptives_control2['PA_Range', "V3"], descriptives_control2['word_Range', "V3"], descriptives_control2['DLS_Range', "V3"])
#T4
Means_t4 <- c(descriptives_control2['PA_Mean', "V4"], descriptives_control2['word_Mean', "V4"], descriptives_control2['DLS_Mean', "V4"])
SDs_t4 <- c(descriptives_control2['PA_SD', "V4"], descriptives_control2['word_SD', "V4"], descriptives_control2['DLS_SD', "V4"])
Range_t4 <- c(descriptives_control2['PA_Range', "V4"], descriptives_control2['word_Range', "V4"], descriptives_control2['DLS_Range', "V4"])

descTable <- data.frame(Response_variable, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)

var_names <- as.data.frame(c( "Word recognition","Sentence", "PA"))

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the Comprehension-based group of included variables presented by time"
  , note = "this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

```{r desc-read-combi-table, dev.args = list(bg = 'white'), include=TRUE, results='asis'}

descriptives_combi <- desc_data2  %>% filter(group == 4) %>% group_by(time) %>%
   summarize_all(list(Mean=~round(mean(., na.rm = T), digits = 2),  SD=~round(sd(., na.rm = T), digits = 2), Range=~paste("(", toString(round(range(., na.rm = T), digits = 0)), ")", sep="")))

#descriptives[, -1] <- printnum(descriptives[, -1])
descriptives_combi2 <- as.data.frame(t(descriptives_combi))

Response_variable <- c("PA", "Word recogniton", "Reading comprehension")
#T1
Means_t1 <- c(descriptives_control2['PA_Mean',"V1"], descriptives_control2['word_Mean',"V1"], descriptives_control2['DLS_Mean',"V1"])
SDs_t1 <- c(descriptives_control2['PA_SD', "V1"], descriptives_control2['word_SD', "V1"], descriptives_control2['DLS_SD', "V1"])
Range_t1 <- c(descriptives_control2['PA_Range', "V1"], descriptives_control2['word_Range', "V1"], descriptives_control2['DLS_Range', "V1"])
#T2
Means_t2 <- c(descriptives_control2['PA_Mean', "V2"], descriptives_control2['word_Mean', "V2"], descriptives_control2['DLS_Mean', "V2"])
SDs_t2 <- c(descriptives_control2['PA_SD', "V2"], descriptives_control2['word_SD', "V2"], descriptives_control2['DLS_SD', "V2"])
Range_t2 <- c(descriptives_control2['PA_Range', "V2"], descriptives_control2['word_Range', "V2"], descriptives_control2['DLS_Range', "V2"])
#T3
Means_t3 <- c(descriptives_control2['PA_Mean', "V3"], descriptives_control2['word_Mean', "V3"], descriptives_control2['DLS_Mean', "V3"])
SDs_t3 <- c(descriptives_control2['PA_SD', "V3"], descriptives_control2['word_SD', "V3"], descriptives_control2['DLS_SD', "V3"])
Range_t3 <- c(descriptives_control2['PA_Range', "V3"], descriptives_control2['word_Range', "V3"], descriptives_control2['DLS_Range', "V3"])
#T4
Means_t4 <- c(descriptives_control2['PA_Mean', "V4"], descriptives_control2['word_Mean', "V4"], descriptives_control2['DLS_Mean', "V4"])
SDs_t4 <- c(descriptives_control2['PA_SD', "V4"], descriptives_control2['word_SD', "V4"], descriptives_control2['DLS_SD', "V4"])
Range_t4 <- c(descriptives_control2['PA_Range', "V4"], descriptives_control2['word_Range', "V4"], descriptives_control2['DLS_Range', "V4"])

descTable <- data.frame(Response_variable, Means_t1, SDs_t1, Range_t1, Means_t2, SDs_t2, Range_t2, Means_t3, SDs_t3, Range_t3, Means_t4, SDs_t4, Range_t4)


var_names <- as.data.frame(c( "Word recognition","Sentence", "PA"))

col.names = c(" ", "$M_{T1}$", "$SD_{T1}$", "$(Range)_{T1}$", "$M_{T2}$", "$SD_{T2}$", "$(Range)_{T2}$", "$M_{T3}$", "$SD_{T3}$", "$(Range)_{T3}$", "$M_{T4}$", "$SD_{T4}$", "$(Range)_{T4}$")

#TODO Cannot get table to print two decimals.
apa_table(
  descTable
  , caption = "Descriptive statistics for the Combi group of included variables presented by time"
  , note = "this is a note."
  , col_spanners = list("T1" = c(2, 4), "T2" = c(5, 7), "T3" = c(8, 10), "T4" = c(11, 13)) # N.B. ignored in Word
  , col.names = col.names
  , row.names = FALSE
  , align = c('l', 'c')
  , font_size = c("small")
)

```

## Intervention implementation

```{r train time in different groups}
kruskal_test_TT <- kruskal.test(tot_train_time~group, data = mlm_data%>% filter(time == 1)%>% filter(group != "Control"))

```

The participants were instructed to train for a total of 18 hours, 1080 minutes. However, the participants ended up with significantly less. On average, the participants trained for `r round(mean((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE), digits = 0) ` (*sd* =`r round(sd((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE), digits = 0) `, *range* =  [`r round(range((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE), digits = 0) `]) minutes, `r round(mean((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE)/60, digits = 2) ` (*sd* =`r round(sd((mlm_data %>% filter(time == 1)%>% filter(group != "Control"))$tot_train_time, na.rm = TRUE)/60, digits = 2) `) hours. There was no difference in instruction duration between the three intervention groups (*H*(`r kruskal_test_TT[["parameter"]]`) = `r kruskal_test_TT[["statistic"]]`, *p* `r p_small(kruskal_test_TT[["p.value"]])` ). 
The combination group trained the PB intervention for 
`r round(mean((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$time_played_ALL_tot, na.rm = TRUE), digits = 0) ` 
(*sd* = `r round(sd((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$time_played_ALL_tot, na.rm = TRUE), digits = 0) `; 
*range* =  [`r round(range((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$time_played_ALL_tot, na.rm = TRUE), digits = 0) `]) minutes 
and the CB intervention for 
`r round(mean((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$time_played_animega, na.rm = TRUE), digits = 0) ` 
(*sd* = `r round(sd((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$time_played_animega, na.rm = TRUE), digits = 0) `; 
*range* =  [`r round(range((mlm_data %>% filter(time == 1)%>% filter(group == "Combi"))$time_played_animega, na.rm = TRUE), digits = 0) `]) minutes. 

The instruction duration for each group can be seen in Figure X.

```{r  tottraintime-plot, include = TRUE, results='asis'}

mlm_data_labels <- mlm_data                     # Duplicate data
levels(mlm_data_labels$group) <- c("Control",  # Relevel factor labels
                                       "PB",
                                       "CB",
                                   "Combi")
ggboxplot(data = mlm_data_labels%>% filter(time == 1)%>% filter(group != "Control"), x = "group", y= "tot_train_time",
          color = "group", palette =c("#00AFBB", "#E7B800", "#FC4E07"),
          names = c("PB", "CB", "Combi"),
          add = "jitter",
          title = "Duration of instruction in each group",
          xlab = F,
          ylab = "Minutes",
          legend = "none")

```

## Phonological awareness

All groups improved in PA with time, `r apa_print(model_PA_3)$full_result$days_scale`, and the participants in the combination group improved more than the participants in the other groups, `r apa_print(model_PA_3)$full_result$days_scale_contrast_4vs23` (see Table\ \@ref(tab:PA-table)). The effect of the phonics-based reading instruction, compared to the comparison group, approached statistical significance, `r apa_print(model_PA_3)$full_result$days_scale_contrast_1vs2`. However, the comprehension-based reading instruction did not lead to better development than the TAU approach in the comparison group, `r apa_print(model_PA_3)$full_result$days_scale_contrast_1vs3` (see Table\ \@ref(tab:PA-table)). In sum, we found support for Hypothesis 3, but not for Hypotheses 1-2.   




```{r PA-table, include = TRUE, results='asis'}
tab_model(model_PA_3,
          show.re.var= T, 
                  pred.labels =c("(Intercept)", "Days", "Control vs PB", "Control vs CB", "PB and CB vs Combi", "Days*Control vs PB", "Days*Control vs CB", "Days*PB and CB vs Combi"),
                  dv.labels= "Effects of Interventions on Phonological Awareness")
```

```{r  PA-plot, include = FALSE, results='asis'}

#Plot data for PA
ggplot(data      = mlm_data,
       aes(x     = days,
           y     = PA,
           col   = group,
           group = group))+ #to add the colours for different classes
  geom_smooth(method   = lm,
              se       = T,
              size     = 1,
              linetype = 1,
              alpha    = .2)+
  theme_minimal()+
  labs(title    = "Change in phonological awareness",
       subtitle = "")+
  scale_color_manual(name   =" Group",
                     labels = c("Control", "PB", "CB", "Combo"),
                     values = c("blue", "red", "green", "yellow"))
```

## Word recognition
For word recognition, participants improved with time, `r apa_print(model_word_3)$full_result$days_scale`. This applied to all four groups, and neither PB (`r apa_print(model_word_3)$full_result$days_scale_contrast_1vs2`), CB (`r apa_print(model_word_3)$full_result$days_scale_contrast_1vs3`), nor the combination of the two instructions (`r apa_print(model_word_3)$full_result$days_scale_contrast_4vs23`) led to a stronger development than what was observed in the comparison group (see  Table\ \@ref(tab:word-table)). Thus, for word reading, we did not find support for Hypotheses 1-3.


```{r word-table, include=TRUE, results='asis'}
tab_model(model_word_3,
          show.re.var= T, 
                  pred.labels =c("(Intercept)", "Days", "Control vs PB", "Control vs CB", "PB and CB vs Combi", "Days*Control vs PB", "Days*Control vs CB", "Days*PB and CB vs Combi"),
                  dv.labels= "Effects of Interventions on Word Recognition")

```

```{r  word-plot, include = FALSE, results='asis'}

#Plot data for word
ggplot(data      = mlm_data,
       aes(x     = days,
           y     = word,
           col   = group,
           group = group))+ #to add the colours for different classes
  geom_smooth(method   = lm,
              se       = T,
              size     = 1,
              linetype = 1,
              alpha    = .2)+
  theme_minimal()+
  labs(title    = "Change in word recognition",
       subtitle = "")+
  scale_color_manual(name   =" Group",
                     labels = c("Control", "PB", "CB", "Combo"),
                     values = c("blue", "red", "green", "yellow"))

```

# Reading comprehension

There was a statistically significant effect of time, `r apa_print(DLS_poisson_3_no_rand_slope)$full_result$days_scale`, indicating that participants improved on reading comprehension, regardless of reading instruction condition. However, we did not see any effects of PB (`r apa_print(DLS_poisson_3_no_rand_slope)$full_result$days_scale_contrast_1vs2`), CB (`r apa_print(DLS_poisson_3_no_rand_slope)$full_result$days_scale_contrast_1vs3`), or the combination of the two instructions (`r apa_print(DLS_poisson_3_no_rand_slope)$full_result$days_scale_contrast_4vs23`; Table\ \@ref(tab:DLS-table)). Thus, hypotheses 1-3 were not supported for reading comprehension. 



```{r DLS-table, include=TRUE, results='asis'}
tab_model(DLS_poisson_3_no_rand_slope,
          show.re.var= T, 
                  pred.labels =c("(Intercept)", "Days", "Control vs PB", "Control vs CB", "PB and CB vs Combi", "Days*Control vs PB", "Days*Control vs CB", "Days*PB and CB vs Combi"),
                  dv.labels= "Effects of Interventions on Reading comprehension")
```

```{r  DLS-plot, include = FALSE, results='asis'}

#Plot data for Reading comprehension
ggplot(data      = mlm_data,
       aes(x     = days,
           y     = DLS,
           col   = group,
           group = group))+ #to add the colours for different classes
  geom_smooth(method   = lm,
              se       = T,
              size     = 1,
              linetype = 1,
              alpha    = .2)+
  theme_minimal()+
  labs(title    = "Change in reading comprehension",
       subtitle = "")+
  scale_color_manual(name   =" Group",
                     labels = c("Control", "PB", "CB", "Combo"),
                     values = c("blue", "red", "green", "yellow"))

```


# Results summary
Both a phonic-based reading strategy and the combination of phonic-based and comprehension-based reading strategies improves development in phonological awareness more than teaching as usual. In addition, the combination group had a steeper development in phonological awareness than either reading strategy on its own. IQ influenced the starting level of phonological awareness, word recognition, and reading comprehension, and was marginally associated with the level of improvement in phonological awareness. 
IQ and PA are important for improving reading ability. IQ might be difficult to change but PA is very much so. Thus, teachers in special needs school should include phonic-based reading strategy training early and throughout school to enable reading acquisition.
phonic-based mer renodlad färdighetsträning (alphabetic coding/phonological coding), som bidrar till ökad fonologisk medvetenhet , comprehension-based bidrar till rikare lexico-semantic representations. Kombinationen bidrar till att eleven får möjlighet att tillämpa sina tillägnade färdigheter i en rik semantisk kontext. Comprehension-based fokuserar för lite på färdigheten?
Utebliven effekt på word recognition talar kanske emot detta, men vi tror att det har att göra med mängden träning och kanske nivån de startar på.
Det beror inte på mängden träning i studien (inga skillnader mellan grupperna) och inte heller IQ (kontroll för det). ID-nivå? Ålder? Kön?
Vad har andra sagt? Om kombinerad träning och teoretiskt vad det representerar? Och specifikt om comprehension-based?


# marginal and conditional R2  
A marginal R2 close to zero tells us that the fixed effects aren’t explaining much variation, and a conditional R2 close to 1 tells us that most of that unexplained variation is between groups (people) rather than between observations within groups (people). So, for example, if the context was a longitudinal cohort study, we wouldn’t expect to improve our model much by collecting more data on characteristics/measures that mainly vary within people, but instead should find characteristics that mainly vary between people.


# Discussion
In the present study, we investigated whether reading interventions targeting either phonic or comprehension-based reading strategies, or a combination of both these strategies, improve reading skills in children with ID, who use ACC. Our pre-registered hypothesis that either reading strategy would improve phonological awareness (Hypothesis 1) was supported by the results, and for the test on phonological awareness, we also found support for Hypothesis 3, that the combined intervention would reveal the steepest development. However, we did not see that intervention improved word or reading comprehension skill (Hypothesis 2). Our exploratory analyses indicated … . Reading intervention might support reading skill development in children with ID who use ACC, but the stages in development cannot be circumvented.

In line with earlier research, we found that reading can be taught to students with ID. Our research adds a large-scale study including students who also benefit from AAC, in practice children with lower cognitive level (i.e. IQ). Earlier literacy intervention studies for students with ID have mainly included children with mild ID, and the ones that have included moderate to severe have mostly been case studies. Our study conclude that even though IQ is important for the acquisition of reading, children with mild to moderate can also benefit from literacy instruction. 

Reading builds on several simultaneous processes, and training programs on these instructional strategies inevitably overlap in the mechanisms that they activate. For example, a comprehension-based instructional strategy does not exclude the possibility to apply phonic-based principles as the meaning of words are sought and when working with a phonic-based approach, lexico-semantic processes (e.g., phonological structures in the lexicon, semantic associations) might influence training outcomes. Still, the emphasis is different across strategies, and it is reasonable to assume that they support development in different reading components. 


##Conclusions
Blablabla

##Declaration of interest
Blablabla


\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
#r_refs(file = "library.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
